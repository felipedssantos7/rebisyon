<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>ðŸ“š Rebisyon</title>
  <link rel="stylesheet" href="css/globals.css">
  <link rel="stylesheet" href="css/index.css">
</head>

<body onload="onLoadBody()">
  <div id="content">
    <div id="navbar">
      <div id="logo">ðŸ“š Rebisyon</div>
      <div id="menu">
        <div class="item selected">Baralhos</div>
        <div class="item" onclick="openFlashcardPage()">Adicionar</div>
        <div class="item">Painel</div>
        <div class="item">EstatÃ­sticas</div>
        <div class="item"><a href="pages/test.html">Sincronizar</a></div>
      </div>
    </div>
    <div id="main">
      <table id="decks-table"></table>
      <div id="info">
        <div id="total">
          <div>
            <b>Total de cartÃµes novos:</b>
            <span id="total-of-news">0</span>
          </div>
          <div>
            <b>Total de cartÃµes para rever:</b>
            <span id="total-to-review">0</span>
          </div>
        </div>
        <div>VocÃª estudou 0 cartÃ£o(Ãµes) em 0 segundo(s) hoje.</div>
      </div>
    </div>
    <div id="footer">
      <button>Obter baralho compartilhado</button>
      <button id="add-deck">Criar novo baralho</button>
      <button>Importar arquivo</button>
    </div>
  </div>
</body>
<script src="js/front/index.js"></script>
<script>
  // Get ipc.
  const { ipcRenderer } = require("electron");

  // To request to open the add flashcard page.
  function openFlashcardPage() {
    ipcRenderer.send("openFlashcardPage");
  }

  // To request list of decks from the database.
  function getDks() {
    ipcRenderer.send("rqtGetDks");
  }

  // To receive list of decks from the database.
  ipcRenderer.on("rcvGetDks", (event, rows) => {
    buildTbody(rows, getCardsNumber, getCardsNumber);
  });

  // To request number of cards from the database.
  function getCardsNumber(deckId, state) {
    ipcRenderer.send("rqtGetCdsNbr", deckId, state);
  }

  // To receive number of cards from the database.
  ipcRenderer.on("rcvGetCdsNbr", (event, state, rows) => {
    if (state == "New") {
      addCdsNmb(rows, 1);
    } else if (state == "Re-study") {
      addCdsNmb(rows, 2);
    } else if (state == "Review") {
      addCdsNmb(rows, 3);
    }
  });

  // To request to add deck in the database.
  document.querySelector("#add-deck").addEventListener("click", (event) => {
    event.preventDefault();
    var name = "Baralho de teste";
    ipcRenderer.send("rqtAddDk", name);
  });

  // To receive the add deck return.
  ipcRenderer.on("rcvAddDk", (event, row) => {
    addRow(row);
  });

  // To request to remove deck from the database.
  function rmDk(deckId) {
      ipcRenderer.send("rqtRmDk", deckId);
  };

  // To receive the remove deck return.
  ipcRenderer.on("rcvRmDk", (event, id) => {
    rmRow(id);
  });

  // To receive some error.
  ipcRenderer.on("error", (event) => {
    alert("An unexpected error has occurred! Please restart your Rebysion!");
  });

</script>
</html>
